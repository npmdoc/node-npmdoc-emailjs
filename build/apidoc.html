<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/eleith/emailjs#readme"

    >emailjs (v1.0.8)</a>
</h1>
<h4>send text/html emails and attachments (files, streams and strings) from node.js to any smtp server</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs">module emailjs</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP">
            function <span class="apidocSignatureSpan">emailjs.</span>SMTP.SMTP
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message">
            function <span class="apidocSignatureSpan">emailjs.</span>message.Message
            <span class="apidocSignatureSpan">(headers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client">
            function <span class="apidocSignatureSpan">emailjs.</span>server.Client
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>SMTP</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>SMTP.SMTP.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>message</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>message.Message.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>response</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>server</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.</span>server.Client.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.SMTP">module emailjs.SMTP</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP">
            function <span class="apidocSignatureSpan">emailjs.</span>SMTP
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.SMTP.</span>authentication</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">emailjs.SMTP.</span>state</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.SMTP.SMTP">module emailjs.SMTP.SMTP</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.SMTP">
            function <span class="apidocSignatureSpan">emailjs.SMTP.</span>SMTP
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.SMTP.SMTP.prototype">module emailjs.SMTP.SMTP.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.addListener">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>addListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.authorized">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>authorized
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.close">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>close
            <span class="apidocSignatureSpan">(force)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.command">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>command
            <span class="apidocSignatureSpan">(cmd, callback, codes, failed)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.connect">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>connect
            <span class="apidocSignatureSpan">(callback, port, host, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.data">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>data
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.data_end">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>data_end
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.debug">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>debug
            <span class="apidocSignatureSpan">(level)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.ehlo">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>ehlo
            <span class="apidocSignatureSpan">(callback, domain)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.ehlo_or_helo_if_needed">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>ehlo_or_helo_if_needed
            <span class="apidocSignatureSpan">(callback, domain)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.emit">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>emit
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.eventNames">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>eventNames
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.expn">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>expn
            <span class="apidocSignatureSpan">(address, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.getMaxListeners">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>getMaxListeners
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.has_extn">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>has_extn
            <span class="apidocSignatureSpan">(opt)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.helo">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>helo
            <span class="apidocSignatureSpan">(callback, domain)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.help">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>help
            <span class="apidocSignatureSpan">(callback, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.listenerCount">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>listenerCount
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.listeners">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>listeners
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.login">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>login
            <span class="apidocSignatureSpan">(callback, user, password, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.mail">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>mail
            <span class="apidocSignatureSpan">(callback, from)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.message">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>message
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.noop">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>noop
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.on">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>on
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.once">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>once
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.parse_smtp_features">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>parse_smtp_features
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.prependListener">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>prependListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.prependOnceListener">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>prependOnceListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.quit">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>quit
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.rcpt">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>rcpt
            <span class="apidocSignatureSpan">(callback, to)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.removeAllListeners">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>removeAllListeners
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.removeListener">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>removeListener
            <span class="apidocSignatureSpan">(type, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.rset">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>rset
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.send">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>send
            <span class="apidocSignatureSpan">(str, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.setMaxListeners">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>setMaxListeners
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.starttls">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>starttls
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.state">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>state
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.SMTP.SMTP.prototype.verify">
            function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>verify
            <span class="apidocSignatureSpan">(address, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">undefined <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>domain</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.message">module emailjs.message</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message">
            function <span class="apidocSignatureSpan">emailjs.message.</span>Message
            <span class="apidocSignatureSpan">(headers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.create">
            function <span class="apidocSignatureSpan">emailjs.message.</span>create
            <span class="apidocSignatureSpan">(headers)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">emailjs.message.</span>BUFFERSIZE</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.message.Message">module emailjs.message.Message</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message.Message">
            function <span class="apidocSignatureSpan">emailjs.message.</span>Message
            <span class="apidocSignatureSpan">(headers)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.message.Message.prototype">module emailjs.message.Message.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message.prototype.attach">
            function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>attach
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message.prototype.attach_alternative">
            function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>attach_alternative
            <span class="apidocSignatureSpan">(html, charset)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message.prototype.read">
            function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>read
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message.prototype.stream">
            function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>stream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.message.Message.prototype.valid">
            function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>valid
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.response">module emailjs.response</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.response.monitor">
            function <span class="apidocSignatureSpan">emailjs.response.</span>monitor
            <span class="apidocSignatureSpan">(stream, timeout, onerror)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.server">module emailjs.server</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client">
            function <span class="apidocSignatureSpan">emailjs.server.</span>Client
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.connect">
            function <span class="apidocSignatureSpan">emailjs.server.</span>connect
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.server.Client">module emailjs.server.Client</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.Client">
            function <span class="apidocSignatureSpan">emailjs.server.</span>Client
            <span class="apidocSignatureSpan">(server)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.emailjs.server.Client.prototype">module emailjs.server.Client.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._connect">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_connect
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._containsInlinedHtml">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_containsInlinedHtml
            <span class="apidocSignatureSpan">(attachment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._isAttachmentInlinedHtml">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_isAttachmentInlinedHtml
            <span class="apidocSignatureSpan">(attachment)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._poll">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_poll
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._senddata">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_senddata
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._senddone">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_senddone
            <span class="apidocSignatureSpan">(err, stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._sendmail">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendmail
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._sendmessage">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendmessage
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._sendrcpt">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendrcpt
            <span class="apidocSignatureSpan">(stack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype._sendsmtp">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendsmtp
            <span class="apidocSignatureSpan">(stack, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.emailjs.server.Client.prototype.send">
            function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>send
            <span class="apidocSignatureSpan">(msg, callback)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs" id="apidoc.module.emailjs">module emailjs</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP" id="apidoc.element.emailjs.SMTP.SMTP">
        function <span class="apidocSignatureSpan">emailjs.</span>SMTP.SMTP
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">SMTP.SMTP = function (options) {
  events.EventEmitter.call(this);

  options = options || {};

  this.sock = null;
  this.timeout = options.timeout || TIMEOUT;
  this.features = null;
  this._state = SMTPState.NOTCONNECTED;
  this._secure = false;
  this.loggedin = (options.user &#x26;&#x26; options.password) ? false : true;
  this.domain = options.domain || os.hostname();
  this.host = options.host || &#x27;localhost&#x27;;
  this.port = options.port || (options.ssl ? SMTP_SSL_PORT : options.tls ? SMTP_TLS_PORT : SMTP_PORT);
  this.ssl = options.ssl || false;
  this.tls = options.tls || false;
  this.monitor = null;
  this.authentication = options.authentication || [AUTH_METHODS.CRAM_MD5, AUTH_METHODS.LOGIN, AUTH_METHODS.PLAIN, AUTH_METHODS.XOAUTH2
];

  // keep these strings hidden when quicky debugging/logging
  this.user = function() {
    return options.user;
  };
  this.password = function() {
    return options.password;
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.message.Message" id="apidoc.element.emailjs.message.Message">
        function <span class="apidocSignatureSpan">emailjs.</span>message.Message
        <span class="apidocSignatureSpan">(headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">message.Message = function (headers)
{
   this.attachments  = [];
   this.alternative  = null;
   var now = new Date();
   this.header       = {
      &#x22;message-id&#x22;:&#x22;&#x3c;&#x22; + now.getTime() + &#x22;.&#x22; + (counter++) + &#x22;.&#x22; + process.pid + &#x22;@&#x22; + os.hostname() +&#x22;&#x3e;&#x22;,
      &#x22;date&#x22;:moment().locale(&#x27;en&#x27;).format(&#x22;ddd, DD MMM YYYY HH:mm:ss ZZ&#x22;)
   };
   this.content      = &#x22;text/plain; charset=utf-8&#x22;;

   for(var header in headers)
   {
      // allow user to override default content-type to override charset or send a single non-text message
      if(/^content-type$/i.test(header))
      {
         this.content = headers[header];
      }
      else if(header == &#x27;text&#x27;)
      {
         this.text = headers[header];
      }
      else if(header == &#x22;attachment&#x22; &#x26;&#x26; typeof (headers[header]) == &#x22;object&#x22;)
      {
         if(Array.isArray(headers[header])) {
            var that = this;

            for (var i = 0, l = headers[header].length; i &#x3c; l; i++) {
              this.attach(headers[header][i]);
            }
         } else {
            this.attach(headers[header]);
         }
      }
      else if(header == &#x27;subject&#x27;)
      {
         this.header.subject = mimelib.encodeMimeWord(headers.subject, &#x27;Q&#x27;, &#x27;utf-8&#x27;);
      }
      else if(/^(cc|bcc|to|from)/i.test(header))
      {
         this.header[header.toLowerCase()] = person2address(headers[header]);
      }
      else
      {
         // allow any headers the user wants to set??
         // if(/cc|bcc|to|from|reply-to|sender|subject|date|message-id/i.test(header))
         this.header[header.toLowerCase()] = headers[header];
      }
   }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client" id="apidoc.element.emailjs.server.Client">
        function <span class="apidocSignatureSpan">emailjs.</span>server.Client
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">server.Client = function (server)
{
   this.smtp         = new smtp.SMTP(server);
   //this.smtp.debug(1);

   this.queue        = [];
   this.timer        = null;
   this.sending      = false;
   this.ready        = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.SMTP" id="apidoc.module.emailjs.SMTP">module emailjs.SMTP</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP" id="apidoc.element.emailjs.SMTP.SMTP">
        function <span class="apidocSignatureSpan">emailjs.</span>SMTP
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">SMTP = function (options) {
  events.EventEmitter.call(this);

  options = options || {};

  this.sock = null;
  this.timeout = options.timeout || TIMEOUT;
  this.features = null;
  this._state = SMTPState.NOTCONNECTED;
  this._secure = false;
  this.loggedin = (options.user &#x26;&#x26; options.password) ? false : true;
  this.domain = options.domain || os.hostname();
  this.host = options.host || &#x27;localhost&#x27;;
  this.port = options.port || (options.ssl ? SMTP_SSL_PORT : options.tls ? SMTP_TLS_PORT : SMTP_PORT);
  this.ssl = options.ssl || false;
  this.tls = options.tls || false;
  this.monitor = null;
  this.authentication = options.authentication || [AUTH_METHODS.CRAM_MD5, AUTH_METHODS.LOGIN, AUTH_METHODS.PLAIN, AUTH_METHODS.XOAUTH2
];

  // keep these strings hidden when quicky debugging/logging
  this.user = function() {
    return options.user;
  };
  this.password = function() {
    return options.password;
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var smtp       = require(&#x27;./smtp&#x27;);
var smtpError    = require(&#x27;./error&#x27;);
var message      = require(&#x27;./message&#x27;);
var addressparser= require(&#x27;addressparser&#x27;);

var Client = function(server)
{
   this.smtp         = new smtp.<span class="apidocCodeKeywordSpan">SMTP</span>(server);
   //this.smtp.debug(1);

   this.queue        = [];
   this.timer        = null;
   this.sending      = false;
   this.ready        = false;
};
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.SMTP.SMTP" id="apidoc.module.emailjs.SMTP.SMTP">module emailjs.SMTP.SMTP</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.SMTP" id="apidoc.element.emailjs.SMTP.SMTP.SMTP">
        function <span class="apidocSignatureSpan">emailjs.SMTP.</span>SMTP
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">SMTP = function (options) {
  events.EventEmitter.call(this);

  options = options || {};

  this.sock = null;
  this.timeout = options.timeout || TIMEOUT;
  this.features = null;
  this._state = SMTPState.NOTCONNECTED;
  this._secure = false;
  this.loggedin = (options.user &#x26;&#x26; options.password) ? false : true;
  this.domain = options.domain || os.hostname();
  this.host = options.host || &#x27;localhost&#x27;;
  this.port = options.port || (options.ssl ? SMTP_SSL_PORT : options.tls ? SMTP_TLS_PORT : SMTP_PORT);
  this.ssl = options.ssl || false;
  this.tls = options.tls || false;
  this.monitor = null;
  this.authentication = options.authentication || [AUTH_METHODS.CRAM_MD5, AUTH_METHODS.LOGIN, AUTH_METHODS.PLAIN, AUTH_METHODS.XOAUTH2
];

  // keep these strings hidden when quicky debugging/logging
  this.user = function() {
    return options.user;
  };
  this.password = function() {
    return options.password;
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var smtp       = require(&#x27;./smtp&#x27;);
var smtpError    = require(&#x27;./error&#x27;);
var message      = require(&#x27;./message&#x27;);
var addressparser= require(&#x27;addressparser&#x27;);

var Client = function(server)
{
   this.smtp         = new smtp.<span class="apidocCodeKeywordSpan">SMTP</span>(server);
   //this.smtp.debug(1);

   this.queue        = [];
   this.timer        = null;
   this.sending      = false;
   this.ready        = false;
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.SMTP.SMTP.prototype" id="apidoc.module.emailjs.SMTP.SMTP.prototype">module emailjs.SMTP.SMTP.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.addListener" id="apidoc.element.emailjs.SMTP.SMTP.prototype.addListener">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>addListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function addListener(type, listener) {
  return _addListener(this, type, listener, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.authorized" id="apidoc.element.emailjs.SMTP.SMTP.prototype.authorized">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>authorized
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">authorized = function () {
  return this.loggedin;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

         // clear out the queue so all callbacks can be called with the same error message
         self.queue.shift();
         self._poll();
      }
   };

   if(!self.smtp.<span class="apidocCodeKeywordSpan">authorized</span>())
      self.smtp.login(begin);

   else
      self.smtp.ehlo_or_helo_if_needed(begin);
}
else {
   stack.callback(err, stack.message);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.close" id="apidoc.element.emailjs.SMTP.SMTP.prototype.close">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>close
        <span class="apidocSignatureSpan">(force)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function (force) {
  if (this.sock) {
    if (force) {
      log(&#x22;smtp connection destroyed!&#x22;);
      this.sock.destroy();
    } else {
      log(&#x22;smtp connection closed.&#x22;);
      this.sock.end();
    }
  }

  if (this.monitor) {
    this.monitor.stop();
    this.monitor = null;
  }

  this._state = SMTPState.NOTCONNECTED;
  this._secure = false;
  this.sock = null;
  this.features = null;
  this.loggedin = !(this.user() &#x26;&#x26; this.password());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   var self = this, stream = stack.message.stream();

   stream.on(&#x27;data&#x27;, function(data) { self.smtp.message(data); });
   stream.on(&#x27;end&#x27;, function() { self.smtp.data_end(self._sendsmtp(stack, function() { self._senddone(null, stack) })); });

   // there is no way to cancel a message while in the DATA portion, so we have to close the socket to prevent
   // a bad email from going out
   stream.on(&#x27;error&#x27;, function(err) { self.smtp.<span class="apidocCodeKeywordSpan">close</span>(); self._senddone(err
, stack); });
},

_senddone: function(err, stack)
{
   var self = this;
   self.sending = false;
   stack.callback(err, stack.message);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.command" id="apidoc.element.emailjs.SMTP.SMTP.prototype.command">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>command
        <span class="apidocSignatureSpan">(cmd, callback, codes, failed)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">command = function (cmd, callback, codes, failed) {
  codes = Array.isArray(codes) ? codes : typeof(codes) == &#x27;number&#x27; ? [codes] : [250];

  var response = function(err, msg) {
    if (err) {
      caller(callback, err);
    } else {
      if (codes.indexOf(Number(msg.code)) != -1) {
        caller(callback, err, msg.data, msg.message);
      } else {
        var errorMessage = &#x22;bad response on command &#x27;&#x22; + cmd.split(&#x27; &#x27;)[0] + &#x22;&#x27;&#x22;;
        if (msg.message) {
          errorMessage += &#x27;: &#x27; + msg.message;
        }
        caller(callback, SMTPError(errorMessage, SMTPError.BADRESPONSE, null, msg.data));
      }
    }
  };

  this.send(cmd + CRLF, response);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    caller(callback, err);
  } else {
    self.parse_smtp_features(data);
    caller(callback, err, data);
  }
};

    this.<span class="apidocCodeKeywordSpan">command</span>(&#x22;helo &#x22; + (domain || this.domain), response);
  },

  starttls: function(callback) {
    var self = this,

response = function(err, msg) {
  if (err) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.connect" id="apidoc.element.emailjs.SMTP.SMTP.prototype.connect">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>connect
        <span class="apidocSignatureSpan">(callback, port, host, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (callback, port, host, options) {
  options = options || {};

  var self = this;

  self.host = host || self.host;
  self.port = port || self.port;
  self.ssl = options.ssl || self.ssl;

  if (self._state != SMTPState.NOTCONNECTED) {
    self.quit(function() {
      self.connect(callback, port, host, options);
    });
    return;
  }

  var connected = function(err) {
    if (!err) {
      log(&#x22;connected: &#x22; + self.host + &#x22;:&#x22; + self.port);

      if (self.ssl &#x26;&#x26; !self.tls) {
        // if key/ca/cert was passed in, check if connection is authorized
        if (typeof(self.ssl) != &#x27;boolean&#x27; &#x26;&#x26; !self.sock.authorized) {
          self.close(true);
          caller(callback, SMTPError(&#x27;could not establish an ssl connection&#x27;, SMTPError.CONNECTIONAUTH, err));
        } else self._secure = true;
      }
    } else {
      self.close(true);
      caller(callback, SMTPError(&#x22;could not connect&#x22;, SMTPError.COULDNOTCONNECT, err));
    }
  };

  var response = function(err, msg) {
    if (err) {
      if (self._state === SMTPState.NOTCONNECTED &#x26;&#x26; !self.sock) {
        return;
      }
      self.close(true);
      caller(callback, err);
    } else if (msg.code == &#x27;220&#x27;) {
      log(msg.data);

      // might happen first, so no need to wait on connected()
      self._state = SMTPState.CONNECTED;
      caller(callback, null, msg.data);
    } else {
      log(&#x22;response (data): &#x22; + msg.data);
      self.quit(function() {
        caller(callback, SMTPError(&#x22;bad response on connection&#x22;, SMTPError.BADRESPONSE, err, msg.data));
      });
    }
  };

  self._state = SMTPState.CONNECTING;
  log(&#x22;connecting: &#x22; + self.host + &#x22;:&#x22; + self.port);

  if (self.ssl) {
    self.sock = tls.connect(self.port, self.host, self.ssl, connected);
  } else {
    self.sock = new net.Socket();
    self.sock.connect(self.port, self.host, connected);
  }

  self.monitor = SMTPResponse.monitor(self.sock, self.timeout, function() {
    self.close(true);
  });
  self.sock.once(&#x27;response&#x27;, response);
  self.sock.once(&#x27;error&#x27;, response); // the socket could reset or throw, so let&#x27;s handle it and let the user know
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 - auth access to an SMTP Server
 - if your service (ex: gmail) uses two-step authentication, use an application specific password

## EXAMPLE USAGE - text only emails

```javascript
var email 	= require(&#x22;./path/to/emailjs/email&#x22;);
var server 	= email.server.<span class="apidocCodeKeywordSpan">connect</span>({
   user:    &#x22;username&#x22;,
   password:&#x22;password&#x22;,
   host:    &#x22;smtp.your-email.com&#x22;,
   ssl:     true
});

// send the message and get a callback with an error or details of the message that was sent
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.data" id="apidoc.element.emailjs.SMTP.SMTP.prototype.data">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>data
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">data = function (callback) {
  this.command(&#x22;data&#x22;, callback, [354]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var self = this, to = stack.to.shift().address;
self.smtp.rcpt(self._sendsmtp(stack, stack.to.length ? self._sendrcpt : self._senddata), &#x27;&#x3c;&#x27;+ to +&#x27;&#x3e;&#x27
;);
   },

   _senddata: function(stack)
   {
var self = this;
self.smtp.<span class="apidocCodeKeywordSpan">data</span>(self._sendsmtp(stack, self._sendmessage));
   },

   _sendmessage: function(stack)
   {
var self = this, stream = stack.message.stream();

stream.on(&#x27;data&#x27;, function(data) { self.smtp.message(data); });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.data_end" id="apidoc.element.emailjs.SMTP.SMTP.prototype.data_end">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>data_end
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">data_end = function (callback) {
  this.command(CRLF + &#x22;.&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

_sendmessage: function(stack)
{
   var self = this, stream = stack.message.stream();

   stream.on(&#x27;data&#x27;, function(data) { self.smtp.message(data); });
   stream.on(&#x27;end&#x27;, function() { self.smtp.<span class="apidocCodeKeywordSpan">data_end</span>(self._sendsmtp(stack, function
() { self._senddone(null, stack) })); });

   // there is no way to cancel a message while in the DATA portion, so we have to close the socket to prevent
   // a bad email from going out
   stream.on(&#x27;error&#x27;, function(err) { self.smtp.close(); self._senddone(err, stack); });
},

_senddone: function(err, stack)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.debug" id="apidoc.element.emailjs.SMTP.SMTP.prototype.debug">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>debug
        <span class="apidocSignatureSpan">(level)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">debug = function (level) {
  DEBUG = level;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var smtpError    = require(&#x27;./error&#x27;);
var message      = require(&#x27;./message&#x27;);
var addressparser= require(&#x27;addressparser&#x27;);

var Client = function(server)
{
   this.smtp         = new smtp.SMTP(server);
   //this.smtp.<span class="apidocCodeKeywordSpan">debug</span>(1);

   this.queue        = [];
   this.timer        = null;
   this.sending      = false;
   this.ready        = false;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.ehlo" id="apidoc.element.emailjs.SMTP.SMTP.prototype.ehlo">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>ehlo
        <span class="apidocSignatureSpan">(callback, domain)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ehlo = function (callback, domain) {
  var self = this,

    response = function(err, data) {
      if (err) {
        caller(callback, err);
      } else {
        self.parse_smtp_features(data);

        if (self.tls &#x26;&#x26; !self._secure) {
          self.starttls(function() {
            self.ehlo(callback, domain);
          });
        } else {
          caller(callback, err, data);
        }
      }
    };

  this.features = {};
  this.command(&#x22;ehlo &#x22; + (domain || this.domain), response);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (err) {
    caller(callback, err);
  } else {
    self.parse_smtp_features(data);

    if (self.tls &#x26;&#x26; !self._secure) {
      self.starttls(function() {
        self.<span class="apidocCodeKeywordSpan">ehlo</span>(callback, domain);
      });
    } else {
      caller(callback, err, data);
    }
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.ehlo_or_helo_if_needed" id="apidoc.element.emailjs.SMTP.SMTP.prototype.ehlo_or_helo_if_needed">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>ehlo_or_helo_if_needed
        <span class="apidocSignatureSpan">(callback, domain)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ehlo_or_helo_if_needed = function (callback, domain) {
  // Call self.ehlo() and/or self.helo() if needed.
  // If there has been no previous EHLO or HELO command self session, self
  //  method tries ESMTP EHLO first.
  var self = this;

  if (!this.features) {
    var response = function(err, data) {
      caller(callback, err, data);
    };

    var attempt = function(err, data) {
      if (err) self.helo(response, domain);
      else caller(callback, err, data);
    };

    self.ehlo(attempt, domain);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   }
};

if(!self.smtp.authorized())
   self.smtp.login(begin);

else
   self.smtp.<span class="apidocCodeKeywordSpan">ehlo_or_helo_if_needed</span>(begin);
         }
         else {
stack.callback(err, stack.message);

// clear out the queue so all callbacks can be called with the same error message
self.queue.shift();
self._poll();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.emit" id="apidoc.element.emailjs.SMTP.SMTP.prototype.emit">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>emit
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function emit(type) {
  var er, handler, len, args, i, events, domain;
  var needDomainExit = false;
  var doError = (type === &#x27;error&#x27;);

  events = this._events;
  if (events)
    doError = (doError &#x26;&#x26; events.error == null);
  else if (!doError)
    return false;

  domain = this.domain;

  // If there is no &#x27;error&#x27; event listener then throw.
  if (doError) {
    er = arguments[1];
    if (domain) {
      if (!er)
        er = new Error(&#x27;Uncaught, unspecified &#x22;error&#x22; event&#x27;);
      er.domainEmitter = this;
      er.domain = domain;
      er.domainThrown = false;
      domain.emit(&#x27;error&#x27;, er);
    } else if (er instanceof Error) {
      throw er; // Unhandled &#x27;error&#x27; event
    } else {
      // At least give some kind of context to the user
      var err = new Error(&#x27;Uncaught, unspecified &#x22;error&#x22; event. (&#x27; + er + &#x27;)&#x27;);
      err.context = er;
      throw err;
    }
    return false;
  }

  handler = events[type];

  if (!handler)
    return false;

  if (domain &#x26;&#x26; this !== process) {
    domain.enter();
    needDomainExit = true;
  }

  var isFn = typeof handler === &#x27;function&#x27;;
  len = arguments.length;
  switch (len) {
    // fast cases
    case 1:
      emitNone(handler, isFn, this);
      break;
    case 2:
      emitOne(handler, isFn, this, arguments[1]);
      break;
    case 3:
      emitTwo(handler, isFn, this, arguments[1], arguments[2]);
      break;
    case 4:
      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);
      break;
    // slower
    default:
      args = new Array(len - 1);
      for (i = 1; i &#x3c; len; i++)
        args[i - 1] = arguments[i];
      emitMany(handler, isFn, this, args);
  }

  if (needDomainExit)
    domain.exit();

  return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
               self.removeListener(&#x22;error&#x22;, closed);
               fs.close(fd, next);
            }
         });
      }
      else
      {
         self.<span class="apidocCodeKeywordSpan">emit</span>(&#x27;error&#x27;, err || {message:&#x22;message stream was interrupted
 somehow!&#x22;});
      }
   };

   fs.read(fd, buffer, 0, chunk, null, read);
   self.once(&#x22;error&#x22;, closed);
}
else
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.eventNames" id="apidoc.element.emailjs.SMTP.SMTP.prototype.eventNames">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>eventNames
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function eventNames() {
  return this._eventsCount &#x3e; 0 ? Reflect.ownKeys(this._events) : [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.expn" id="apidoc.element.emailjs.SMTP.SMTP.prototype.expn">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>expn
        <span class="apidocSignatureSpan">(address, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expn = function (address, callback) {
  // SMTP &#x27;expn&#x27; command -- expands a mailing list.
  this.command(&#x22;expn &#x22; + address, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.getMaxListeners" id="apidoc.element.emailjs.SMTP.SMTP.prototype.getMaxListeners">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>getMaxListeners
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getMaxListeners() {
  return $getMaxListeners(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.has_extn" id="apidoc.element.emailjs.SMTP.SMTP.prototype.has_extn">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>has_extn
        <span class="apidocSignatureSpan">(opt)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">has_extn = function (opt) {
  return this.features[opt.toLowerCase()] === undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.helo" id="apidoc.element.emailjs.SMTP.SMTP.prototype.helo">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>helo
        <span class="apidocSignatureSpan">(callback, domain)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">helo = function (callback, domain) {
<span class="apidocCodeCommentSpan">  /*
   * SMTP &#x27;helo&#x27; command.
   * Hostname to send for self command defaults to the FQDN of the local
   * host.
   */
</span>
  var self = this,

    response = function(err, data) {
      if (err) {
        caller(callback, err);
      } else {
        self.parse_smtp_features(data);
        caller(callback, err, data);
      }
    };

  this.command(&#x22;helo &#x22; + (domain || this.domain), response);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  expn: function(address, callback) {
// SMTP &#x27;expn&#x27; command -- expands a mailing list.
this.command(&#x22;expn &#x22; + address, callback);
  },

  ehlo_or_helo_if_needed: function(callback, domain) {
// Call self.ehlo() and/or self.<span class="apidocCodeKeywordSpan">helo</span>() if needed.
// If there has been no previous EHLO or HELO command self session, self
//  method tries ESMTP EHLO first.
var self = this;

if (!this.features) {
  var response = function(err, data) {
    caller(callback, err, data);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.help" id="apidoc.element.emailjs.SMTP.SMTP.prototype.help">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>help
        <span class="apidocSignatureSpan">(callback, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">help = function (callback, args) {
  // SMTP &#x27;help&#x27; command, returns text from the server
  this.command(args ? &#x22;help &#x22; + args : &#x22;help&#x22;, callback, [211, 214]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.listenerCount" id="apidoc.element.emailjs.SMTP.SMTP.prototype.listenerCount">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>listenerCount
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listenerCount(type) {
  const events = this._events;

  if (events) {
    const evlistener = events[type];

    if (typeof evlistener === &#x27;function&#x27;) {
      return 1;
    } else if (evlistener) {
      return evlistener.length;
    }
  }

  return 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.listeners" id="apidoc.element.emailjs.SMTP.SMTP.prototype.listeners">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>listeners
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listeners(type) {
  var evlistener;
  var ret;
  var events = this._events;

  if (!events)
    ret = [];
  else {
    evlistener = events[type];
    if (!evlistener)
      ret = [];
    else if (typeof evlistener === &#x27;function&#x27;)
      ret = [evlistener];
    else
      ret = arrayClone(evlistener, evlistener.length);
  }

  return ret;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.login" id="apidoc.element.emailjs.SMTP.SMTP.prototype.login">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>login
        <span class="apidocSignatureSpan">(callback, user, password, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">login = function (callback, user, password, options) {
  var self = this,

    login = {
      user: user ? function() {
        return user;
      } : self.user,
      password: password ? function() {
        return password;
      } : self.password,
      method: options &#x26;&#x26; options.method ? options.method.toUpperCase() : &#x27;&#x27;
    },

    domain = options &#x26;&#x26; options.domain ? options.domain : this.domain,

    initiate = function(err, data) {
      if (err) {
        caller(callback, err);
        return;
      }

<span class="apidocCodeCommentSpan">      /*
       * Log in on an SMTP server that requires authentication.
       *
       * The arguments are:
       *     - user:     The user name to authenticate with.
       *     - password: The password for the authentication.
       *
       * If there has been no previous EHLO or HELO command self session, self
       * method tries ESMTP EHLO first.
       *
       * This method will return normally if the authentication was successful.
       */
</span>
      var method = null,

        encode_cram_md5 = function(challenge) {
          challenge = (new Buffer(challenge, &#x22;base64&#x22;)).toString(&#x22;ascii&#x22;);

          var hmac = crypto.createHmac(&#x27;md5&#x27;, login.password());
          hmac.update(challenge);

          return (new Buffer(login.user() + &#x22; &#x22; + hmac.digest(&#x27;hex&#x27;)).toString(&#x22;base64&#x22;));
        },

        encode_plain = function() {
          return (new Buffer(&#x22;\u0000&#x22; + login.user() + &#x22;\u0000&#x22; + login.password())).toString(&#x22;base64&#x22;);
        },

        encode_xoauth2 = function() {
          // console.log(&#x22;user=&#x22; + login.user() + &#x22;\1auth=Bearer &#x22; + login.password()+&#x22;\1\1&#x22;);
          // see: https://developers.google.com/gmail/xoauth2_protocol
          return (new Buffer(&#x22;user=&#x22; + login.user() + &#x22;\u0001auth=Bearer &#x22; + login.password() + &#x22;\u0001\u0001&#x22;)).toString(&#x22;base64
&#x22;);
        };

      // List of authentication methods we support: from preferred to
      // less preferred methods.
      if (!method) {
        var preferred = self.authentication;

        for (var i = 0; i &#x3c; preferred.length; i++) {
          if ((self.features.auth || &#x22;&#x22;).indexOf(preferred[i]) != -1) {
            method = preferred[i];
            break;
          }
        }
      }

      // handle bad responses from command differently
      var failed = function(err, data) {
        self.loggedin = false;
        self.close(); // if auth is bad, close the connection, it won&#x27;t get better by itself
        caller(callback, SMTPError(&#x27;authorization.failed&#x27;, SMTPError.AUTHFAILED, err, data));
      };

      var response = function(err, data) {
        if (err) {
          failed(err, data);
        } else {
          self.loggedin = true;
          caller(callback, err, data);
        }
      };

      var attempt = function(err, data, msg) {
        if (err) {
          failed(err, data);
        } else {
          if (method == AUTH_METHODS.CRAM_MD5) {
            self.command(encode_cram_md5(msg), response, [235, 503]);
          } else if (method == AUTH_METHODS.LOGIN) {
            self.command((new Buffer(login.password())).toString(&#x22;base64&#x22;), response, [235, 503]);
          }
        }
      };

      var attempt_user = function(err, data, msg) {
        if (err) {
          failed(err, data);
        } else {
          if (method == AUTH_METHODS.LOGIN) {
            self.command((new Buffer(login.user())).toString(&#x22;base64&#x22;), attempt, [334]);
          }
        }
      };

      if (method == AUTH_METHODS.CRAM_MD5) self.command(&#x22;AUTH &#x22; + AUTH_METHODS.CRAM_MD5, attempt, [334]);

      else if (method == AUTH_METHODS.LOGIN) self.command(&#x22;AUTH &#x22; + AUTH_METHODS.LOGIN, attempt_user, [334]);

      else if (method == AUTH_METHODS.PLAIN) self.command(&#x22;AUTH &#x22; + AUTH_METHODS.PLAIN + &#x22; &#x22; + encode_plain(login.user(), login.
password()), response, [235, 503]);

      else if (method == AUTH_METHODS.XOAUTH2) self.command(&#x22;AUTH &#x22; + AUTH_METHODS.XOAUTH2 + &#x22; &#x22; + encode_xoauth2(login.user(),
login.password()), response, [235, 503]);

      else if (!method) caller(callback, SMTPError(&#x27;no form of authorization supported&#x27;, SMTPError.AUTHNOTSU ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         // clear out the queue so all callbacks can be called with the same error message
         self.queue.shift();
         self._poll();
      }
   };

   if(!self.smtp.authorized())
      self.smtp.<span class="apidocCodeKeywordSpan">login</span>(begin);

   else
      self.smtp.ehlo_or_helo_if_needed(begin);
}
else {
   stack.callback(err, stack.message);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.mail" id="apidoc.element.emailjs.SMTP.SMTP.prototype.mail">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>mail
        <span class="apidocSignatureSpan">(callback, from)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mail = function (callback, from) {
  this.command(&#x22;mail FROM:&#x22; + from, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

_sendmail: function(stack)
{
   var self = this;
   var from = stack.returnPath || stack.from;
   self.sending = true;
   self.smtp.<span class="apidocCodeKeywordSpan">mail</span>(self._sendsmtp(stack, self._sendrcpt), &#x27;&#x3c;&#x27; + from + &#
x27;&#x3e;&#x27;);
},

_sendrcpt: function(stack)
{
   var self = this, to = stack.to.shift().address;
   self.smtp.rcpt(self._sendsmtp(stack, stack.to.length ? self._sendrcpt : self._senddata), &#x27;&#x3c;&#x27;+ to +&#x27;&#x3e;&#
x27;);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.message" id="apidoc.element.emailjs.SMTP.SMTP.prototype.message">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>message
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">message = function (data) {
  log(data);
  this.sock.write(data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   self.smtp.data(self._sendsmtp(stack, self._sendmessage));
},

_sendmessage: function(stack)
{
   var self = this, stream = stack.message.stream();

   stream.on(&#x27;data&#x27;, function(data) { self.smtp.<span class="apidocCodeKeywordSpan">message</span>(data); });
   stream.on(&#x27;end&#x27;, function() { self.smtp.data_end(self._sendsmtp(stack, function() { self._senddone(null, stack) })); });

   // there is no way to cancel a message while in the DATA portion, so we have to close the socket to prevent
   // a bad email from going out
   stream.on(&#x27;error&#x27;, function(err) { self.smtp.close(); self._senddone(err, stack); });
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.noop" id="apidoc.element.emailjs.SMTP.SMTP.prototype.noop">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>noop
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">noop = function (callback) {
  this.send(&#x22;noop&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.on" id="apidoc.element.emailjs.SMTP.SMTP.prototype.on">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>on
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function addListener(type, listener) {
  return _addListener(this, type, listener, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   self.smtp.data(self._sendsmtp(stack, self._sendmessage));
},

_sendmessage: function(stack)
{
   var self = this, stream = stack.message.stream();

   stream.<span class="apidocCodeKeywordSpan">on</span>(&#x27;data&#x27;, function(data) { self.smtp.message(data); });
   stream.on(&#x27;end&#x27;, function() { self.smtp.data_end(self._sendsmtp(stack, function() { self._senddone(null, stack) })); });

   // there is no way to cancel a message while in the DATA portion, so we have to close the socket to prevent
   // a bad email from going out
   stream.on(&#x27;error&#x27;, function(err) { self.smtp.close(); self._senddone(err, stack); });
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.once" id="apidoc.element.emailjs.SMTP.SMTP.prototype.once">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>once
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function once(type, listener) {
  if (typeof listener !== &#x27;function&#x27;)
    throw new TypeError(&#x27;&#x22;listener&#x22; argument must be a function&#x27;);
  this.on(type, _onceWrap(this, type, listener));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            else
            {
               self.emit(&#x27;error&#x27;, err || {message:&#x22;message stream was interrupted somehow!&#x22;});
            }
         };

         fs.read(fd, buffer, 0, chunk, null, read);
         self.<span class="apidocCodeKeywordSpan">once</span>(&#x22;error&#x22;, closed);
      }
      else
         self.emit(&#x27;error&#x27;, err);
   };

   fs.open(attachment.path, &#x27;r&#x27;, opened);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.parse_smtp_features" id="apidoc.element.emailjs.SMTP.SMTP.prototype.parse_smtp_features">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>parse_smtp_features
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse_smtp_features = function (data) {
  var self = this;

  //  According to RFC1869 some (badly written)
  //  MTA&#x27;s will disconnect on an ehlo. Toss an exception if
  //  that happens -ddm

  data.split(&#x22;\n&#x22;).forEach(function(ext) {
    var parse = ext.match(/^(?:\d+[\-=]?)\s*?([^\s]+)(?:\s+(.*)\s*?)?$/);

    // To be able to communicate with as many SMTP servers as possible,
    // we have to take the old-style auth advertisement into account,
    // because:
    // 1) Else our SMTP feature parser gets confused.
    // 2) There are some servers that only advertise the auth methods we
    // support using the old style.

    if (parse) {
      // RFC 1869 requires a space between ehlo keyword and parameters.
      // It&#x27;s actually stricter, in that only spaces are allowed between
      // parameters, but were not going to check for that here.  Note
      // that the space isn&#x27;t present if there are no parameters.
      self.features[parse[1].toLowerCase()] = parse[2] || true;
    }
  });

  return;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  var self = this,

    response = function(err, data) {
      if (err) {
        caller(callback, err);
      } else {
        self.<span class="apidocCodeKeywordSpan">parse_smtp_features</span>(data);
        caller(callback, err, data);
      }
    };

  this.command(&#x22;helo &#x22; + (domain || this.domain), response);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.prependListener" id="apidoc.element.emailjs.SMTP.SMTP.prototype.prependListener">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>prependListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function prependListener(type, listener) {
  return _addListener(this, type, listener, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.prependOnceListener" id="apidoc.element.emailjs.SMTP.SMTP.prototype.prependOnceListener">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>prependOnceListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function prependOnceListener(type, listener) {
  if (typeof listener !== &#x27;function&#x27;)
    throw new TypeError(&#x27;&#x22;listener&#x22; argument must be a function&#x27;);
  this.prependListener(type, _onceWrap(this, type, listener));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.quit" id="apidoc.element.emailjs.SMTP.SMTP.prototype.quit">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>quit
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">quit = function (callback) {
  var self = this,
    response = function(err, data) {
      caller(callback, err, data);
      self.close();
    };

  this.command(&#x22;quit&#x22;, response, [221, 250]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      self._connect(self.queue[0]);

   else if(self.smtp.state() == smtp.state.CONNECTED &#x26;&#x26; !self.sending &#x26;&#x26; self.ready)
      self._sendmail(self.queue.shift());
}
// wait around 1 seconds in case something does come in, otherwise close out SMTP connection if still open
else if(self.smtp.state() == smtp.state.CONNECTED)
   self.timer = setTimeout(function() { self.smtp.<span class="apidocCodeKeywordSpan">quit</span>(); }, 1000);
   },

   _connect: function(stack)
   {
var self = this,

connect = function(err)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.rcpt" id="apidoc.element.emailjs.SMTP.SMTP.prototype.rcpt">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>rcpt
        <span class="apidocSignatureSpan">(callback, to)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rcpt = function (callback, to) {
  this.command(&#x22;RCPT TO:&#x22; + to, callback, [250, 251]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   self.sending = true;
   self.smtp.mail(self._sendsmtp(stack, self._sendrcpt), &#x27;&#x3c;&#x27; + from + &#x27;&#x3e;&#x27;);
},

_sendrcpt: function(stack)
{
   var self = this, to = stack.to.shift().address;
   self.smtp.<span class="apidocCodeKeywordSpan">rcpt</span>(self._sendsmtp(stack, stack.to.length ? self._sendrcpt : self._senddata
), &#x27;&#x3c;&#x27;+ to +&#x27;&#x3e;&#x27;);
},

_senddata: function(stack)
{
   var self = this;
   self.smtp.data(self._sendsmtp(stack, self._sendmessage));
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.removeAllListeners" id="apidoc.element.emailjs.SMTP.SMTP.prototype.removeAllListeners">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>removeAllListeners
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeAllListeners(type) {
  var listeners, events;

  events = this._events;
  if (!events)
    return this;

  // not listening for removeListener, no need to emit
  if (!events.removeListener) {
    if (arguments.length === 0) {
      this._events = new EventHandlers();
      this._eventsCount = 0;
    } else if (events[type]) {
      if (--this._eventsCount === 0)
        this._events = new EventHandlers();
      else
        delete events[type];
    }
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    var keys = Object.keys(events);
    for (var i = 0, key; i &#x3c; keys.length; ++i) {
      key = keys[i];
      if (key === &#x27;removeListener&#x27;) continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners(&#x27;removeListener&#x27;);
    this._events = new EventHandlers();
    this._eventsCount = 0;
    return this;
  }

  listeners = events[type];

  if (typeof listeners === &#x27;function&#x27;) {
    this.removeListener(type, listeners);
  } else if (listeners) {
    // LIFO order
    do {
      this.removeListener(type, listeners[listeners.length - 1]);
    } while (listeners[0]);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      self.emit(&#x27;data&#x27;, self.buffer.toString(&#x22;utf-8&#x22;, 0, self.bufferIndex));
      self.emit(&#x27;end&#x27;);
   }

   self.buffer = null;
   self.bufferIndex = 0;
   self.readable = false;
   self.<span class="apidocCodeKeywordSpan">removeAllListeners</span>(&#x22;resume&#x22;);
   self.removeAllListeners(&#x22;pause&#x22;);
   self.removeAllListeners(&#x22;error&#x22;);
   self.removeAllListeners(&#x22;data&#x22;);
   self.removeAllListeners(&#x22;end&#x22;);
};

self.once(&#x22;destroy&#x22;, close);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.removeListener" id="apidoc.element.emailjs.SMTP.SMTP.prototype.removeListener">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>removeListener
        <span class="apidocSignatureSpan">(type, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeListener(type, listener) {
  var list, events, position, i, originalListener;

  if (typeof listener !== &#x27;function&#x27;)
    throw new TypeError(&#x27;&#x22;listener&#x22; argument must be a function&#x27;);

  events = this._events;
  if (!events)
    return this;

  list = events[type];
  if (!list)
    return this;

  if (list === listener || list.listener === listener) {
    if (--this._eventsCount === 0)
      this._events = new EventHandlers();
    else {
      delete events[type];
      if (events.removeListener)
        this.emit(&#x27;removeListener&#x27;, type, list.listener || listener);
    }
  } else if (typeof list !== &#x27;function&#x27;) {
    position = -1;

    for (i = list.length; i-- &#x3e; 0;) {
      if (list[i] === listener || list[i].listener === listener) {
        originalListener = list[i].listener;
        position = i;
        break;
      }
    }

    if (position &#x3c; 0)
      return this;

    if (list.length === 1) {
      list[0] = undefined;
      if (--this._eventsCount === 0) {
        this._events = new EventHandlers();
        return this;
      } else {
        delete events[type];
      }
    } else {
      spliceOne(list, position);
    }

    if (events.removeListener)
      this.emit(&#x27;removeListener&#x27;, type, originalListener || listener);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   {
      if(bytes == chunk) // we read a full chunk, there might be more
      {
         fs.read(fd, buffer, 0, chunk, null, read);
      }
      else // that was the last chunk, we are done reading the file
      {
         self.<span class="apidocCodeKeywordSpan">removeListener</span>(&#x22;error&#x22;, closed);
         fs.close(fd, next);
      }
   });
}
else
{
   self.emit(&#x27;error&#x27;, err || {message:&#x22;message stream was interrupted somehow!&#x22;});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.rset" id="apidoc.element.emailjs.SMTP.SMTP.prototype.rset">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>rset
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rset = function (callback) {
  this.command(&#x22;rset&#x22;, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      {
         next.apply(self, [stack]);
      }
      else
      {
         // if we snag on SMTP commands, call done, passing the error
         // but first reset SMTP state so queue can continue polling
         self.smtp.<span class="apidocCodeKeywordSpan">rset</span>(function() { self._senddone(err, stack); });
      }
   };

   return check;
},

_sendmail: function(stack)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.send" id="apidoc.element.emailjs.SMTP.SMTP.prototype.send">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>send
        <span class="apidocSignatureSpan">(str, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (str, callback) {
  var self = this;

  if (self.sock &#x26;&#x26; self._state == SMTPState.CONNECTED) {
    log(str);

    var response = function(err, msg) {
      if (err) {
        caller(callback, err);
      } else {
        log(msg.data);
        caller(callback, null, msg);
      }
    };

    self.sock.once(&#x27;response&#x27;, response);
    self.sock.write(str);
  } else {
    self.close(true);
    caller(callback, SMTPError(&#x27;no connection has been established&#x27;, SMTPError.NOCONNECTION));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   user:    &#x22;username&#x22;,
   password:&#x22;password&#x22;,
   host:    &#x22;smtp.your-email.com&#x22;,
   ssl:     true
});

// send the message and get a callback with an error or details of the message that was sent
server.<span class="apidocCodeKeywordSpan">send</span>({
   text:    &#x22;i hope this works&#x22;,
   from:    &#x22;you &#x3c;username@your-email.com&#x3e;&#x22;,
   to:      &#x22;someone &#x3c;someone@your-email.com&#x3e;, another &#x3c;another@your-email.com&#x3e;&#x22;,
   cc:      &#x22;else &#x3c;else@your-email.com&#x3e;&#x22;,
   subject: &#x22;testing emailjs&#x22;
}, function(err, message) { console.log(err || message); });
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.setMaxListeners" id="apidoc.element.emailjs.SMTP.SMTP.prototype.setMaxListeners">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>setMaxListeners
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function setMaxListeners(n) {
  if (typeof n !== &#x27;number&#x27; || n &#x3c; 0 || isNaN(n))
    throw new TypeError(&#x27;&#x22;n&#x22; argument must be a positive number&#x27;);
  this._maxListeners = n;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.starttls" id="apidoc.element.emailjs.SMTP.SMTP.prototype.starttls">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>starttls
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">starttls = function (callback) {
  var self = this,

    response = function(err, msg) {
      if (err) {
        err.message += &#x22; while establishing a starttls session&#x22;;
        caller(callback, err);
      } else {
        // support new API
        if (tls.TLSSocket) {
          var secured_socket = new tls.TLSSocket(self.sock, {
            secureContext: tls.createSecureContext ? tls.createSecureContext(self.tls) : crypto.createCredentials(self.tls),
            isServer: false // older versions of node (0.12), do not default to false properly...
          });

          secured_socket.on(&#x27;error&#x27;, function(err) {
            self.close(true);
            caller(callback, err);
          });

          self._secure = true;
          self.sock = secured_socket;

          SMTPResponse.monitor(self.sock, self.timeout, function() {
            self.close(true);
          });
          caller(callback, msg.data);
        } else {
          var secured_socket = null;
          var secured = function() {
            self._secure = true;
            self.sock = secured_socket;

            var error = function(err) {
              self.close(true);
              caller(callback, err);
            };

            SMTPResponse.monitor(self.sock, self.timeout, function() {
              self.close(true);
            });
            caller(callback, msg.data);
          };

          //secured_socket = starttls.secure(self.sock, self.tls, secured);
          var starttls = require(&#x27;starttls&#x27;);
          secured_socket = starttls({
            socket: self.sock,
            host: self.host,
            port: self.port,
            pair: tls.createSecurePair(
              tls.createSecureContext ? tls.createSecureContext(self.tls) : crypto.createCredentials(self.tls),
              false)
          }, secured).cleartext;

          secured_socket.on(&#x27;error&#x27;, function(err) {
            self.close(true);
            caller(callback, err);
          });
        }
      }
    };

  this.command(&#x22;starttls&#x22;, response, [220]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
response = function(err, data) {
  if (err) {
    caller(callback, err);
  } else {
    self.parse_smtp_features(data);

    if (self.tls &#x26;&#x26; !self._secure) {
      self.<span class="apidocCodeKeywordSpan">starttls</span>(function() {
        self.ehlo(callback, domain);
      });
    } else {
      caller(callback, err, data);
    }
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.state" id="apidoc.element.emailjs.SMTP.SMTP.prototype.state">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>state
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">state = function () {
  return this._state;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   {
var self = this;

clearTimeout(self.timer);

if(self.queue.length)
{
   if(self.smtp.<span class="apidocCodeKeywordSpan">state</span>() == smtp.state.NOTCONNECTED)
      self._connect(self.queue[0]);

   else if(self.smtp.state() == smtp.state.CONNECTED &#x26;&#x26; !self.sending &#x26;&#x26; self.ready)
      self._sendmail(self.queue.shift());
}
// wait around 1 seconds in case something does come in, otherwise close out SMTP connection if still open
else if(self.smtp.state() == smtp.state.CONNECTED)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.SMTP.SMTP.prototype.verify" id="apidoc.element.emailjs.SMTP.SMTP.prototype.verify">
        function <span class="apidocSignatureSpan">emailjs.SMTP.SMTP.prototype.</span>verify
        <span class="apidocSignatureSpan">(address, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">verify = function (address, callback) {
  // SMTP &#x27;verify&#x27; command -- checks for address validity.&#x22;&#x22;&#x22;
  this.command(&#x22;vrfy &#x22; + address, callback, [250, 251, 252]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.message" id="apidoc.module.emailjs.message">module emailjs.message</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.message.Message" id="apidoc.element.emailjs.message.Message">
        function <span class="apidocSignatureSpan">emailjs.message.</span>Message
        <span class="apidocSignatureSpan">(headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Message = function (headers)
{
   this.attachments  = [];
   this.alternative  = null;
   var now = new Date();
   this.header       = {
      &#x22;message-id&#x22;:&#x22;&#x3c;&#x22; + now.getTime() + &#x22;.&#x22; + (counter++) + &#x22;.&#x22; + process.pid + &#x22;@&#x22; + os.hostname() +&#x22;&#x3e;&#x22;,
      &#x22;date&#x22;:moment().locale(&#x27;en&#x27;).format(&#x22;ddd, DD MMM YYYY HH:mm:ss ZZ&#x22;)
   };
   this.content      = &#x22;text/plain; charset=utf-8&#x22;;

   for(var header in headers)
   {
      // allow user to override default content-type to override charset or send a single non-text message
      if(/^content-type$/i.test(header))
      {
         this.content = headers[header];
      }
      else if(header == &#x27;text&#x27;)
      {
         this.text = headers[header];
      }
      else if(header == &#x22;attachment&#x22; &#x26;&#x26; typeof (headers[header]) == &#x22;object&#x22;)
      {
         if(Array.isArray(headers[header])) {
            var that = this;

            for (var i = 0, l = headers[header].length; i &#x3c; l; i++) {
              this.attach(headers[header][i]);
            }
         } else {
            this.attach(headers[header]);
         }
      }
      else if(header == &#x27;subject&#x27;)
      {
         this.header.subject = mimelib.encodeMimeWord(headers.subject, &#x27;Q&#x27;, &#x27;utf-8&#x27;);
      }
      else if(/^(cc|bcc|to|from)/i.test(header))
      {
         this.header[header.toLowerCase()] = person2address(headers[header]);
      }
      else
      {
         // allow any headers the user wants to set??
         // if(/cc|bcc|to|from|reply-to|sender|subject|date|message-id/i.test(header))
         this.header[header.toLowerCase()] = headers[header];
      }
   }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.message.create" id="apidoc.element.emailjs.message.create">
        function <span class="apidocSignatureSpan">emailjs.message.</span>create
        <span class="apidocSignatureSpan">(headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (headers)
{
   return new Message(headers);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   {
var self = this;

if(!(msg instanceof message.Message)
    &#x26;&#x26; msg.from
    &#x26;&#x26; (msg.to || msg.cc || msg.bcc)
    &#x26;&#x26; (msg.text || this._containsInlinedHtml(msg.attachment)))
   msg = message.<span class="apidocCodeKeywordSpan">create</span>(msg);

if(msg instanceof message.Message)
{
   msg.valid(function(valid, why)
   {
      if(valid)
      {
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.message.Message" id="apidoc.module.emailjs.message.Message">module emailjs.message.Message</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.message.Message.Message" id="apidoc.element.emailjs.message.Message.Message">
        function <span class="apidocSignatureSpan">emailjs.message.</span>Message
        <span class="apidocSignatureSpan">(headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Message = function (headers)
{
   this.attachments  = [];
   this.alternative  = null;
   var now = new Date();
   this.header       = {
      &#x22;message-id&#x22;:&#x22;&#x3c;&#x22; + now.getTime() + &#x22;.&#x22; + (counter++) + &#x22;.&#x22; + process.pid + &#x22;@&#x22; + os.hostname() +&#x22;&#x3e;&#x22;,
      &#x22;date&#x22;:moment().locale(&#x27;en&#x27;).format(&#x22;ddd, DD MMM YYYY HH:mm:ss ZZ&#x22;)
   };
   this.content      = &#x22;text/plain; charset=utf-8&#x22;;

   for(var header in headers)
   {
      // allow user to override default content-type to override charset or send a single non-text message
      if(/^content-type$/i.test(header))
      {
         this.content = headers[header];
      }
      else if(header == &#x27;text&#x27;)
      {
         this.text = headers[header];
      }
      else if(header == &#x22;attachment&#x22; &#x26;&#x26; typeof (headers[header]) == &#x22;object&#x22;)
      {
         if(Array.isArray(headers[header])) {
            var that = this;

            for (var i = 0, l = headers[header].length; i &#x3c; l; i++) {
              this.attach(headers[header][i]);
            }
         } else {
            this.attach(headers[header]);
         }
      }
      else if(header == &#x27;subject&#x27;)
      {
         this.header.subject = mimelib.encodeMimeWord(headers.subject, &#x27;Q&#x27;, &#x27;utf-8&#x27;);
      }
      else if(/^(cc|bcc|to|from)/i.test(header))
      {
         this.header[header.toLowerCase()] = person2address(headers[header]);
      }
      else
      {
         // allow any headers the user wants to set??
         // if(/cc|bcc|to|from|reply-to|sender|subject|date|message-id/i.test(header))
         this.header[header.toLowerCase()] = headers[header];
      }
   }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.message.Message.prototype" id="apidoc.module.emailjs.message.Message.prototype">module emailjs.message.Message.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.message.Message.prototype.attach" id="apidoc.element.emailjs.message.Message.prototype.attach">
        function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>attach
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">attach = function (options)
{
<span class="apidocCodeCommentSpan">   /*
      legacy support, will remove eventually...
      arguments -&#x3e; (path, type, name, headers)
   */
</span>   if (arguments.length &#x3e; 1)
     options = {path:options, type:arguments[1], name:arguments[2]};

   // sender can specify an attachment as an alternative
   if(options.alternative)
   {
      this.alternative           = options;
      this.alternative.charset   = options.charset || &#x22;utf-8&#x22;;
      this.alternative.type      = options.type || &#x22;text/html&#x22;;
      this.alternative.inline    = true;
   }
   else
      this.attachments.push(options);

   return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}
else if(header == &#x22;attachment&#x22; &#x26;&#x26; typeof (headers[header]) == &#x22;object&#x22;)
{
   if(Array.isArray(headers[header])) {
      var that = this;

      for (var i = 0, l = headers[header].length; i &#x3c; l; i++) {
        this.<span class="apidocCodeKeywordSpan">attach</span>(headers[header][i]);
      }
   } else {
      this.attach(headers[header]);
   }
}
else if(header == &#x27;subject&#x27;)
{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.message.Message.prototype.attach_alternative" id="apidoc.element.emailjs.message.Message.prototype.attach_alternative">
        function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>attach_alternative
        <span class="apidocSignatureSpan">(html, charset)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">attach_alternative = function (html, charset)
{
   this.alternative =
   {
      data:    html,
      charset: charset || &#x22;utf-8&#x22;,
      type:    &#x22;text/html&#x22;,
      inline:  true
   };

   return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.message.Message.prototype.read" id="apidoc.element.emailjs.message.Message.prototype.read">
        function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>read
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (callback)
{
   var buffer = &#x22;&#x22;;

   var capture = function(data)
   {
      buffer += data;
   };

   var output = function(err)
   {
      callback(err, buffer);
   };

   var str = this.stream();

   str.on(&#x27;data&#x27;, capture);
   str.on(&#x27;end&#x27;, output);
   str.on(&#x27;error&#x27;, output);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if(!err &#x26;&#x26; self.readable)
{
   // guaranteed to be encoded without padding unless it is our last read
   output_base64(buffer.toString(&#x22;base64&#x22;, 0, bytes), function()
   {
      if(bytes == chunk) // we read a full chunk, there might be more
      {
         fs.<span class="apidocCodeKeywordSpan">read</span>(fd, buffer, 0, chunk, null, read);
      }
      else // that was the last chunk, we are done reading the file
      {
         self.removeListener(&#x22;error&#x22;, closed);
         fs.close(fd, next);
      }
   });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.message.Message.prototype.stream" id="apidoc.element.emailjs.message.Message.prototype.stream">
        function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>stream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stream = function ()
{
   return new MessageStream(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   {
var self = this;
self.smtp.data(self._sendsmtp(stack, self._sendmessage));
   },

   _sendmessage: function(stack)
   {
var self = this, stream = stack.message.<span class="apidocCodeKeywordSpan">stream</span>();

stream.on(&#x27;data&#x27;, function(data) { self.smtp.message(data); });
stream.on(&#x27;end&#x27;, function() { self.smtp.data_end(self._sendsmtp(stack, function() { self._senddone(null, stack) })); });

// there is no way to cancel a message while in the DATA portion, so we have to close the socket to prevent
// a bad email from going out
stream.on(&#x27;error&#x27;, function(err) { self.smtp.close(); self._senddone(err, stack); });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.message.Message.prototype.valid" id="apidoc.element.emailjs.message.Message.prototype.valid">
        function <span class="apidocSignatureSpan">emailjs.message.Message.prototype.</span>valid
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">valid = function (callback)
{
   var self = this;

   if(!self.header.from)
   {
      callback(false, &#x22;message does not have a valid sender&#x22;);
   }
   if(!(self.header.to || self.header.cc || self.header.bcc))
   {
      callback(false, &#x22;message does not have a valid recipient&#x22;);
   }
   else if(self.attachments.length === 0)
   {
      callback(true);
   }
   else
   {
      var check  = [];
      var failed = [];

      self.attachments.forEach(function(attachment, index)
      {
         if(attachment.path)
         {
            // migrating path-&#x3e;fs for existsSync)
            if(!(fs.existsSync || path.existsSync)(attachment.path))
               failed.push(attachment.path + &#x22; does not exist&#x22;);
         }
         else if(attachment.stream)
         {
            if(!attachment.stream.readable)
               failed.push(&#x22;attachment stream is not readable&#x22;);
         }
         else if(!attachment.data)
         {
            failed.push(&#x22;attachment has no data associated with it&#x22;);
         }
      });

      callback(failed.length === 0, failed.join(&#x22;, &#x22;));
   }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    &#x26;&#x26; msg.from
    &#x26;&#x26; (msg.to || msg.cc || msg.bcc)
    &#x26;&#x26; (msg.text || this._containsInlinedHtml(msg.attachment)))
   msg = message.create(msg);

if(msg instanceof message.Message)
{
   msg.<span class="apidocCodeKeywordSpan">valid</span>(function(valid, why)
   {
      if(valid)
      {
         var stack =
         {
            message:    msg,
            to:         addressparser(msg.header.to),
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.response" id="apidoc.module.emailjs.response">module emailjs.response</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.response.monitor" id="apidoc.element.emailjs.response.monitor">
        function <span class="apidocSignatureSpan">emailjs.response.</span>monitor
        <span class="apidocSignatureSpan">(stream, timeout, onerror)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">monitor = function (stream, timeout, onerror)
{
  return new SMTPResponse(stream, timeout, onerror);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (self.ssl) {
    self.sock = tls.connect(self.port, self.host, self.ssl, connected);
  } else {
    self.sock = new net.Socket();
    self.sock.connect(self.port, self.host, connected);
  }

  self.monitor = SMTPResponse.<span class="apidocCodeKeywordSpan">monitor</span>(self.sock, self.timeout, function() {
    self.close(true);
  });
  self.sock.once(&#x27;response&#x27;, response);
  self.sock.once(&#x27;error&#x27;, response); // the socket could reset or throw, so let&#x27;s handle it and let the user know
},

send: function(str, callback) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.server" id="apidoc.module.emailjs.server">module emailjs.server</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.server.Client" id="apidoc.element.emailjs.server.Client">
        function <span class="apidocSignatureSpan">emailjs.server.</span>Client
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Client = function (server)
{
   this.smtp         = new smtp.SMTP(server);
   //this.smtp.debug(1);

   this.queue        = [];
   this.timer        = null;
   this.sending      = false;
   this.ready        = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.connect" id="apidoc.element.emailjs.server.connect">
        function <span class="apidocSignatureSpan">emailjs.server.</span>connect
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (server)
{
   return new Client(server);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 - auth access to an SMTP Server
 - if your service (ex: gmail) uses two-step authentication, use an application specific password

## EXAMPLE USAGE - text only emails

```javascript
var email 	= require(&#x22;./path/to/emailjs/email&#x22;);
var server 	= email.server.<span class="apidocCodeKeywordSpan">connect</span>({
   user:    &#x22;username&#x22;,
   password:&#x22;password&#x22;,
   host:    &#x22;smtp.your-email.com&#x22;,
   ssl:     true
});

// send the message and get a callback with an error or details of the message that was sent
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.server.Client" id="apidoc.module.emailjs.server.Client">module emailjs.server.Client</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.server.Client.Client" id="apidoc.element.emailjs.server.Client.Client">
        function <span class="apidocSignatureSpan">emailjs.server.</span>Client
        <span class="apidocSignatureSpan">(server)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Client = function (server)
{
   this.smtp         = new smtp.SMTP(server);
   //this.smtp.debug(1);

   this.queue        = [];
   this.timer        = null;
   this.sending      = false;
   this.ready        = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.emailjs.server.Client.prototype" id="apidoc.module.emailjs.server.Client.prototype">module emailjs.server.Client.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._connect" id="apidoc.element.emailjs.server.Client.prototype._connect">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_connect
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_connect = function (stack)
{
   var self = this,

   connect = function(err)
   {
      if(!err)
      {
         var begin = function(err)
         {
            if(!err)
            {
               self.ready = true;
               self._poll();
            }
            else {
               stack.callback(err, stack.message);

               // clear out the queue so all callbacks can be called with the same error message
               self.queue.shift();
               self._poll();
            }
         };

         if(!self.smtp.authorized())
            self.smtp.login(begin);

         else
            self.smtp.ehlo_or_helo_if_needed(begin);
      }
      else {
         stack.callback(err, stack.message);

         // clear out the queue so all callbacks can be called with the same error message
         self.queue.shift();
         self._poll();
      }
   };

   self.ready = false;
   self.smtp.connect(connect);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var self = this;

clearTimeout(self.timer);

if(self.queue.length)
{
   if(self.smtp.state() == smtp.state.NOTCONNECTED)
      self.<span class="apidocCodeKeywordSpan">_connect</span>(self.queue[0]);

   else if(self.smtp.state() == smtp.state.CONNECTED &#x26;&#x26; !self.sending &#x26;&#x26; self.ready)
      self._sendmail(self.queue.shift());
}
// wait around 1 seconds in case something does come in, otherwise close out SMTP connection if still open
else if(self.smtp.state() == smtp.state.CONNECTED)
   self.timer = setTimeout(function() { self.smtp.quit(); }, 1000);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._containsInlinedHtml" id="apidoc.element.emailjs.server.Client.prototype._containsInlinedHtml">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_containsInlinedHtml
        <span class="apidocSignatureSpan">(attachment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_containsInlinedHtml = function (attachment) {
	   if (Array.isArray(attachment)) {
		   return attachment.some((function(ctx) {
			   return function(att) {
				   return ctx._isAttachmentInlinedHtml(att);
			   };
		   })(this));
	   } else {
		   return this._isAttachmentInlinedHtml(attachment);
	   }
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   send: function(msg, callback)
   {
var self = this;

if(!(msg instanceof message.Message)
    &#x26;&#x26; msg.from
    &#x26;&#x26; (msg.to || msg.cc || msg.bcc)
    &#x26;&#x26; (msg.text || this.<span class="apidocCodeKeywordSpan">_containsInlinedHtml</span>(msg.attachment)))
   msg = message.create(msg);

if(msg instanceof message.Message)
{
   msg.valid(function(valid, why)
   {
      if(valid)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._isAttachmentInlinedHtml" id="apidoc.element.emailjs.server.Client.prototype._isAttachmentInlinedHtml">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_isAttachmentInlinedHtml
        <span class="apidocSignatureSpan">(attachment)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_isAttachmentInlinedHtml = function (attachment) {
	   return attachment &#x26;&#x26;
		  (attachment.data || attachment.path) &#x26;&#x26;
		   attachment.alternative === true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         callback(new Error(&#x22;message is not a valid Message instance&#x22;), msg);
   },

   _containsInlinedHtml: function(attachment) {
	   if (Array.isArray(attachment)) {
		   return attachment.some((function(ctx) {
			   return function(att) {
				   return ctx.<span class="apidocCodeKeywordSpan">_isAttachmentInlinedHtml</span>(att);
			   };
		   })(this));
	   } else {
		   return this._isAttachmentInlinedHtml(attachment);
	   }
	},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._poll" id="apidoc.element.emailjs.server.Client.prototype._poll">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_poll
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_poll = function ()
{
   var self = this;

   clearTimeout(self.timer);

   if(self.queue.length)
   {
      if(self.smtp.state() == smtp.state.NOTCONNECTED)
         self._connect(self.queue[0]);

      else if(self.smtp.state() == smtp.state.CONNECTED &#x26;&#x26; !self.sending &#x26;&#x26; self.ready)
         self._sendmail(self.queue.shift());
   }
   // wait around 1 seconds in case something does come in, otherwise close out SMTP connection if still open
   else if(self.smtp.state() == smtp.state.CONNECTED)
      self.timer = setTimeout(function() { self.smtp.quit(); }, 1000);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
         if(!err)
         {
            var begin = function(err)
            {
               if(!err)
               {
self.ready = true;
self.<span class="apidocCodeKeywordSpan">_poll</span>();
               }
               else {
stack.callback(err, stack.message);

// clear out the queue so all callbacks can be called with the same error message
self.queue.shift();
self._poll();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._senddata" id="apidoc.element.emailjs.server.Client.prototype._senddata">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_senddata
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_senddata = function (stack)
{
   var self = this;
   self.smtp.data(self._sendsmtp(stack, self._sendmessage));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._senddone" id="apidoc.element.emailjs.server.Client.prototype._senddone">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_senddone
        <span class="apidocSignatureSpan">(err, stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_senddone = function (err, stack)
{
   var self = this;
   self.sending = false;
   stack.callback(err, stack.message);
   self._poll();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      {
         next.apply(self, [stack]);
      }
      else
      {
         // if we snag on SMTP commands, call done, passing the error
         // but first reset SMTP state so queue can continue polling
         self.smtp.rset(function() { self.<span class="apidocCodeKeywordSpan">_senddone</span>(err, stack); });
      }
   };

   return check;
},

_sendmail: function(stack)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._sendmail" id="apidoc.element.emailjs.server.Client.prototype._sendmail">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendmail
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendmail = function (stack)
{
   var self = this;
   var from = stack.returnPath || stack.from;
   self.sending = true;
   self.smtp.mail(self._sendsmtp(stack, self._sendrcpt), &#x27;&#x3c;&#x27; + from + &#x27;&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

   if(self.queue.length)
   {
      if(self.smtp.state() == smtp.state.NOTCONNECTED)
         self._connect(self.queue[0]);

      else if(self.smtp.state() == smtp.state.CONNECTED &#x26;&#x26; !self.sending &#x26;&#x26; self.ready)
         self.<span class="apidocCodeKeywordSpan">_sendmail</span>(self.queue.shift());
   }
   // wait around 1 seconds in case something does come in, otherwise close out SMTP connection if still open
   else if(self.smtp.state() == smtp.state.CONNECTED)
      self.timer = setTimeout(function() { self.smtp.quit(); }, 1000);
},

_connect: function(stack)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._sendmessage" id="apidoc.element.emailjs.server.Client.prototype._sendmessage">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendmessage
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendmessage = function (stack)
{
   var self = this, stream = stack.message.stream();

   stream.on(&#x27;data&#x27;, function(data) { self.smtp.message(data); });
   stream.on(&#x27;end&#x27;, function() { self.smtp.data_end(self._sendsmtp(stack, function() { self._senddone(null, stack) })); });

   // there is no way to cancel a message while in the DATA portion, so we have to close the socket to prevent
   // a bad email from going out
   stream.on(&#x27;error&#x27;, function(err) { self.smtp.close(); self._senddone(err, stack); });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._sendrcpt" id="apidoc.element.emailjs.server.Client.prototype._sendrcpt">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendrcpt
        <span class="apidocSignatureSpan">(stack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendrcpt = function (stack)
{
   var self = this, to = stack.to.shift().address;
   self.smtp.rcpt(self._sendsmtp(stack, stack.to.length ? self._sendrcpt : self._senddata), &#x27;&#x3c;&#x27;+ to +&#x27;&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype._sendsmtp" id="apidoc.element.emailjs.server.Client.prototype._sendsmtp">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>_sendsmtp
        <span class="apidocSignatureSpan">(stack, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendsmtp = function (stack, next)
{
   var self   = this;
   var check= function(err)
   {
      if(!err &#x26;&#x26; next)
      {
         next.apply(self, [stack]);
      }
      else
      {
         // if we snag on SMTP commands, call done, passing the error
         // but first reset SMTP state so queue can continue polling
         self.smtp.rset(function() { self._senddone(err, stack); });
      }
   };

   return check;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
},

_sendmail: function(stack)
{
   var self = this;
   var from = stack.returnPath || stack.from;
   self.sending = true;
   self.smtp.mail(self.<span class="apidocCodeKeywordSpan">_sendsmtp</span>(stack, self._sendrcpt), &#x27;&#x3c;&#x27; + from + &#
x27;&#x3e;&#x27;);
},

_sendrcpt: function(stack)
{
   var self = this, to = stack.to.shift().address;
   self.smtp.rcpt(self._sendsmtp(stack, stack.to.length ? self._sendrcpt : self._senddata), &#x27;&#x3c;&#x27;+ to +&#x27;&#x3e;&#
x27;);
},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.emailjs.server.Client.prototype.send" id="apidoc.element.emailjs.server.Client.prototype.send">
        function <span class="apidocSignatureSpan">emailjs.server.Client.prototype.</span>send
        <span class="apidocSignatureSpan">(msg, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (msg, callback)
{
   var self = this;

   if(!(msg instanceof message.Message)
       &#x26;&#x26; msg.from
       &#x26;&#x26; (msg.to || msg.cc || msg.bcc)
       &#x26;&#x26; (msg.text || this._containsInlinedHtml(msg.attachment)))
      msg = message.create(msg);

   if(msg instanceof message.Message)
   {
      msg.valid(function(valid, why)
      {
         if(valid)
         {
            var stack =
            {
               message:    msg,
               to:         addressparser(msg.header.to),
               from:       addressparser(msg.header.from)[0].address,
               callback:   callback || function() {}
            };

            if(msg.header.cc)
               stack.to = stack.to.concat(addressparser(msg.header.cc));

            if(msg.header.bcc)
               stack.to = stack.to.concat(addressparser(msg.header.bcc));

            if(msg.header[&#x27;return-path&#x27;] &#x26;&#x26; addressparser(msg.header[&#x27;return-path&#x27;]).length)
              stack.returnPath = addressparser(msg.header[&#x27;return-path&#x27;])[0].address;

            self.queue.push(stack);
            self._poll();
         }
         else
            callback(new Error(why), msg);
      });
   }
   else
      callback(new Error(&#x22;message is not a valid Message instance&#x22;), msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   user:    &#x22;username&#x22;,
   password:&#x22;password&#x22;,
   host:    &#x22;smtp.your-email.com&#x22;,
   ssl:     true
});

// send the message and get a callback with an error or details of the message that was sent
server.<span class="apidocCodeKeywordSpan">send</span>({
   text:    &#x22;i hope this works&#x22;,
   from:    &#x22;you &#x3c;username@your-email.com&#x3e;&#x22;,
   to:      &#x22;someone &#x3c;someone@your-email.com&#x3e;, another &#x3c;another@your-email.com&#x3e;&#x22;,
   cc:      &#x22;else &#x3c;else@your-email.com&#x3e;&#x22;,
   subject: &#x22;testing emailjs&#x22;
}, function(err, message) { console.log(err || message); });
```
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
